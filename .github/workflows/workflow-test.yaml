name: Test end-to-end

run-name: "Test end-to-end (${{ github.event.deployment.environment }})"

on:
  deployment_status:

jobs:
  quality-gate-test-end-to-end:
    name: "Quality gate: Test end-to-end"
    if: github.event.deployment.environment == 'Preview â€“ ovenwand-com' && github.event.deployment_status.state == 'success'
    runs-on: ubuntu-latest
    container:
      image: mcr.microsoft.com/playwright:v1.35.0-jammy
    outputs:
      test_result: ${{ steps.test-end-to-end.outcome }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup environment
        uses: ./.github/actions/common/environment/setup

      - id: test-end-to-end
        name: Test end-to-end
        uses: ./.github/actions/jobs/test/test-end-to-end
        with:
          base_url: ${{ github.event.deployment_status.target_url }}
